###
# AUTHENTICATION REQUIRED
# All update-password requests require a valid JWT Bearer token
# Obtain a token by calling POST /auth/login first
# Replace YOUR_JWT_TOKEN_HERE with your actual token
###

### Update Password - Valid Request
POST http://localhost:3000/auth/update-password
Content-Type: application/json
Authorization: Bearer YOUR_JWT_TOKEN_HERE

{
  "email": "test@example.com",
  "currentPassword": "Test1234!",
  "newPassword": "NewTest1234!"
}

### Update Password - Invalid Current Password
POST http://localhost:3000/auth/update-password
Content-Type: application/json
Authorization: Bearer YOUR_JWT_TOKEN_HERE

{
  "email": "test@example.com",
  "currentPassword": "WrongPassword123!",
  "newPassword": "NewTest1234!"
}

### Update Password - Email Mismatch with Token (Security Test)
# This should return 401 Unauthorized - prevents credential stuffing
POST http://localhost:3000/auth/update-password
Content-Type: application/json
Authorization: Bearer YOUR_JWT_TOKEN_HERE

{
  "email": "different@example.com",
  "currentPassword": "Test1234!",
  "newPassword": "NewTest1234!"
}

### Update Password - Missing Authentication Token
POST http://localhost:3000/auth/update-password
Content-Type: application/json

{
  "email": "test@example.com",
  "currentPassword": "Test1234!",
  "newPassword": "NewTest1234!"
}

### Update Password - New Password Same as Current (Case Insensitive)
POST http://localhost:3000/auth/update-password
Content-Type: application/json
Authorization: Bearer YOUR_JWT_TOKEN_HERE

{
  "email": "test@example.com",
  "currentPassword": "Test1234!",
  "newPassword": "test1234!"
}

### Update Password - Weak New Password (Missing Special Character)
POST http://localhost:3000/auth/update-password
Content-Type: application/json
Authorization: Bearer YOUR_JWT_TOKEN_HERE

{
  "email": "test@example.com",
  "currentPassword": "Test1234!",
  "newPassword": "Test1234"
}

### Update Password - Weak New Password (Too Short)
POST http://localhost:3000/auth/update-password
Content-Type: application/json
Authorization: Bearer YOUR_JWT_TOKEN_HERE

{
  "email": "test@example.com",
  "currentPassword": "Test1234!",
  "newPassword": "Test1!"
}

### Update Password - New Password Same as Email (Case Insensitive)
POST http://localhost:3000/auth/update-password
Content-Type: application/json
Authorization: Bearer YOUR_JWT_TOKEN_HERE

{
  "email": "test@example.com",
  "currentPassword": "Test1234!",
  "newPassword": "TEST@EXAMPLE.COM"
}

### Update Password - Invalid Email Format
POST http://localhost:3000/auth/update-password
Content-Type: application/json
Authorization: Bearer YOUR_JWT_TOKEN_HERE

{
  "email": "invalid-email",
  "currentPassword": "Test1234!",
  "newPassword": "NewTest1234!"
}

### Update Password - Missing Current Password
POST http://localhost:3000/auth/update-password
Content-Type: application/json
Authorization: Bearer YOUR_JWT_TOKEN_HERE

{
  "email": "test@example.com",
  "newPassword": "NewTest1234!"
}

### Update Password - Missing New Password
POST http://localhost:3000/auth/update-password
Content-Type: application/json
Authorization: Bearer YOUR_JWT_TOKEN_HERE

{
  "email": "test@example.com",
  "currentPassword": "Test1234!"
}

### Update Password - New Password Contains Whitespace
POST http://localhost:3000/auth/update-password
Content-Type: application/json
Authorization: Bearer YOUR_JWT_TOKEN_HERE

{
  "email": "test@example.com",
  "currentPassword": "Test1234!",
  "newPassword": "New Test1234!"
}
